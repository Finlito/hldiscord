import{dotnet as e}from"../_framework/dotnet.js";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})})),n}var i={};var r=new TextEncoder;function o(e,t,n){e.length>50?function(e,t,n){r.encodeInto(e,t.subarray(n))}(e,t,n):function(e,t,n){for(var i=e.length,r=n,o=0;o<i;){var s=e.charCodeAt(o++);if(4294967168&s){if(4294965248&s){if(s>=55296&&s<=56319&&o<i){var a=e.charCodeAt(o);56320==(64512&a)&&(++o,s=((1023&s)<<10)+(1023&a)+65536)}4294901760&s?(t[r++]=s>>18&7|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128):(t[r++]=s>>12&15|224,t[r++]=s>>6&63|128)}else t[r++]=s>>6&31|192;t[r++]=63&s|128}else t[r++]=s}}(e,t,n)}var s=4096;function a(e,t,n){for(var i=t,r=i+n,o=[],a="";i<r;){var c=e[i++];if(128&c)if(192==(224&c)){var u=63&e[i++];o.push((31&c)<<6|u)}else if(224==(240&c)){u=63&e[i++];var h=63&e[i++];o.push((31&c)<<12|u<<6|h)}else if(240==(248&c)){var l=(7&c)<<18|(u=63&e[i++])<<12|(h=63&e[i++])<<6|63&e[i++];l>65535&&(l-=65536,o.push(l>>>10&1023|55296),l=56320|1023&l),o.push(l)}else o.push(c);else o.push(c);o.length>=s&&(a+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(a+=String.fromCharCode.apply(String,o)),a}var c=new TextDecoder;function u(e,t,n){return n>200?function(e,t,n){var i=e.subarray(t,t+n);return c.decode(i)}(e,t,n):a(e,t,n)}var h,l=function(e,t){this.type=e,this.data=t},f=(h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},h(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(n){var i=e.call(this,n)||this,r=Object.create(t.prototype);return Object.setPrototypeOf(i,r),Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:t.name}),i}return f(t,e),t}(Error),p=4294967295;function y(e,t,n){var i=Math.floor(n/4294967296),r=n;e.setUint32(t,i),e.setUint32(t+4,r)}function w(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var g=4294967295,v=17179869183;function b(e){var t=e.sec,n=e.nsec;if(t>=0&&n>=0&&t<=v){if(0===n&&t<=g){var i=new Uint8Array(4);return(s=new DataView(i.buffer)).setUint32(0,t),i}var r=t/4294967296,o=4294967295&t;i=new Uint8Array(8);return(s=new DataView(i.buffer)).setUint32(0,n<<2|3&r),s.setUint32(4,o),i}var s;i=new Uint8Array(12);return(s=new DataView(i.buffer)).setUint32(0,n),y(s,4,t),i}function m(e){var t=e.getTime(),n=Math.floor(t/1e3),i=1e6*(t-1e3*n),r=Math.floor(i/1e9);return{sec:n+r,nsec:i-1e9*r}}function S(e){return e instanceof Date?b(m(e)):null}function U(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:w(t,4),nsec:t.getUint32(0)};default:throw new d("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}function x(e){var t=U(e);return new Date(1e3*t.sec+t.nsec/1e6)}var B={type:-1,encode:S,decode:x},A=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(B)}return e.prototype.register=function(e){var t=e.type,n=e.encode,i=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=i;else{var r=1+t;this.builtInEncoders[r]=n,this.builtInDecoders[r]=i}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++){if(null!=(i=this.builtInEncoders[n]))if(null!=(r=i(e,t)))return new l(-1-n,r)}for(n=0;n<this.encoders.length;n++){var i,r;if(null!=(i=this.encoders[n]))if(null!=(r=i(e,t)))return new l(n,r)}return e instanceof l?e:null},e.prototype.decode=function(e,t,n){var i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,n):new l(t,e)},e.defaultCodec=new e,e}();function E(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var I=function(){function e(e){var t,n,i,r,o,s,a,c;this.extensionCodec=null!==(t=null==e?void 0:e.extensionCodec)&&void 0!==t?t:A.defaultCodec,this.context=null==e?void 0:e.context,this.useBigInt64=null!==(n=null==e?void 0:e.useBigInt64)&&void 0!==n&&n,this.maxDepth=null!==(i=null==e?void 0:e.maxDepth)&&void 0!==i?i:100,this.initialBufferSize=null!==(r=null==e?void 0:e.initialBufferSize)&&void 0!==r?r:2048,this.sortKeys=null!==(o=null==e?void 0:e.sortKeys)&&void 0!==o&&o,this.forceFloat32=null!==(s=null==e?void 0:e.forceFloat32)&&void 0!==s&&s,this.ignoreUndefined=null!==(a=null==e?void 0:e.ignoreUndefined)&&void 0!==a&&a,this.forceIntegerToFloat=null!==(c=null==e?void 0:e.forceIntegerToFloat)&&void 0!==c&&c,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),i=new DataView(t);n.set(this.bytes),this.view=i,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)},e.prototype.encodeNumberAsFloat=function(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.encodeBigInt64=function(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){var t=function(e){for(var t=e.length,n=0,i=0;i<t;){var r=e.charCodeAt(i++);if(4294967168&r)if(4294965248&r){if(r>=55296&&r<=56319&&i<t){var o=e.charCodeAt(i);56320==(64512&o)&&(++i,r=((1023&r)<<10)+(1023&o)+65536)}n+=4294901760&r?4:3}else n+=2;else n++}return n}(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),o(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=E(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var i=0,r=e;i<r.length;i++){var o=r[i];this.doEncode(o,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,i=0,r=t;i<r.length;i++){void 0!==e[r[i]]&&n++}return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var i=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else{if(!(i<4294967296))throw new Error("Too large map object: ".concat(i));this.writeU8(223),this.writeU32(i)}for(var r=0,o=n;r<o.length;r++){var s=o[r],a=e[s];this.ignoreUndefined&&void 0===a||(this.encodeString(s),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var i=n/4294967296,r=n;e.setUint32(t,i),e.setUint32(t+4,r)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),y(this.view,this.pos,e),this.pos+=8},e.prototype.writeBigUint64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8},e.prototype.writeBigInt64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8},e}();function T(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var k=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var i=0,r=this.caches[n-1];i<r.length;i++){for(var o=r[i],s=o.bytes,a=0;a<n;a++)if(s[a]!==e[t+a])continue e;return o.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],i={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)},e.prototype.decode=function(e,t,n){var i=this.find(e,t,n);if(null!=i)return this.hit++,i;this.miss++;var r=a(e,t,n),o=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(o,r),r},e}(),_=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},M=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},L=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}},D=function(e){return this instanceof D?(this.v=e,this):new D(e)},O=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof D?Promise.resolve(n.value.v).then(c,u):h(o[0][2],n)}catch(e){h(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},C="array",P="map_key",j=new DataView(new ArrayBuffer(0)),F=new Uint8Array(j.buffer);try{j.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}var z=RangeError,V=new z("Insufficient data"),N=new k,W=function(){function e(e){var t,n,i,r,o,s,a;this.totalPos=0,this.pos=0,this.view=j,this.bytes=F,this.headByte=-1,this.stack=[],this.extensionCodec=null!==(t=null==e?void 0:e.extensionCodec)&&void 0!==t?t:A.defaultCodec,this.context=null==e?void 0:e.context,this.useBigInt64=null!==(n=null==e?void 0:e.useBigInt64)&&void 0!==n&&n,this.maxStrLength=null!==(i=null==e?void 0:e.maxStrLength)&&void 0!==i?i:p,this.maxBinLength=null!==(r=null==e?void 0:e.maxBinLength)&&void 0!==r?r:p,this.maxArrayLength=null!==(o=null==e?void 0:e.maxArrayLength)&&void 0!==o?o:p,this.maxMapLength=null!==(s=null==e?void 0:e.maxMapLength)&&void 0!==s?s:p,this.maxExtLength=null!==(a=null==e?void 0:e.maxExtLength)&&void 0!==a?a:p,this.keyDecoder=void 0!==(null==e?void 0:e.keyDecoder)?e.keyDecoder:N}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=E(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=E(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=E(e),i=new Uint8Array(t.length+n.length);i.set(t),i.set(n,t.length),this.setBuffer(i)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return M(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,i,r,o,s,a;return _(this,void 0,void 0,(function(){var c,u,h,l,f,d,p,y;return M(this,(function(w){switch(w.label){case 0:c=!1,w.label=1;case 1:w.trys.push([1,6,7,12]),t=!0,n=L(e),w.label=2;case 2:return[4,n.next()];case 3:if(i=w.sent(),r=i.done)return[3,5];a=i.value,t=!1;try{if(h=a,c)throw this.createExtraByteError(this.totalPos);this.appendBuffer(h);try{u=this.doDecodeSync(),c=!0}catch(e){if(!(e instanceof z))throw e}this.totalPos+=this.pos}finally{t=!0}w.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return l=w.sent(),o={error:l},[3,12];case 7:return w.trys.push([7,,10,11]),t||r||!(s=n.return)?[3,9]:[4,s.call(n)];case 8:w.sent(),w.label=9;case 9:return[3,11];case 10:if(o)throw o.error;return[7];case 11:return[7];case 12:if(c){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,u]}throw d=(f=this).headByte,p=f.pos,y=f.totalPos,new RangeError("Insufficient data in parsing ".concat(T(d)," at ").concat(y," (").concat(p," in the current buffer)"))}}))}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return O(this,arguments,(function(){var n,i,r,o,s,a,c,u,h,l,f,d;return M(this,(function(p){switch(p.label){case 0:n=t,i=-1,p.label=1;case 1:p.trys.push([1,15,16,21]),r=!0,o=L(e),p.label=2;case 2:return[4,D(o.next())];case 3:if(s=p.sent(),h=s.done)return[3,14];d=s.value,r=!1,p.label=4;case 4:if(p.trys.push([4,,12,13]),a=d,t&&0===i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a),n&&(i=this.readArraySize(),n=!1,this.complete()),p.label=5;case 5:p.trys.push([5,10,,11]),p.label=6;case 6:return[4,D(this.doDecodeSync())];case 7:return[4,p.sent()];case 8:return p.sent(),0==--i?[3,9]:[3,6];case 9:return[3,11];case 10:if(!((c=p.sent())instanceof z))throw c;return[3,11];case 11:return this.totalPos+=this.pos,[3,13];case 12:return r=!0,[7];case 13:return[3,2];case 14:return[3,21];case 15:return u=p.sent(),l={error:u},[3,21];case 16:return p.trys.push([16,,19,20]),r||h||!(f=o.return)?[3,18]:[4,D(f.call(o))];case 17:p.sent(),p.label=18;case 18:return[3,20];case 19:if(l)throw l.error;return[7];case 20:return[7];case 21:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!==(i=e-128)){this.pushMapState(i),this.complete();continue e}t={}}else if(e<160){if(0!==(i=e-144)){this.pushArrayState(i),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){n=this.lookU8();t=this.decodeUtf8String(n,1)}else if(218===e){n=this.lookU16();t=this.decodeUtf8String(n,2)}else if(219===e){n=this.lookU32();t=this.decodeUtf8String(n,4)}else if(220===e){if(0!==(i=this.readU16())){this.pushArrayState(i),this.complete();continue e}t=[]}else if(221===e){if(0!==(i=this.readU32())){this.pushArrayState(i),this.complete();continue e}t=[]}else if(222===e){if(0!==(i=this.readU16())){this.pushMapState(i),this.complete();continue e}t={}}else if(223===e){if(0!==(i=this.readU32())){this.pushMapState(i),this.complete();continue e}t={}}else if(196===e){var i=this.lookU8();t=this.decodeBinary(i,1)}else if(197===e){i=this.lookU16();t=this.decodeBinary(i,2)}else if(198===e){i=this.lookU32();t=this.decodeBinary(i,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){i=this.lookU8();t=this.decodeExtension(i,1)}else if(200===e){i=this.lookU16();t=this.decodeExtension(i,2)}else{if(201!==e)throw new d("Unrecognized type byte: ".concat(T(e)));i=this.lookU32();t=this.decodeExtension(i,4)}this.complete();for(var r=this.stack;r.length>0;){var o=r[r.length-1];if(o.type===C){if(o.array[o.position]=t,o.position++,o.position!==o.size)continue e;r.pop(),t=o.array}else{if(o.type===P){if("string"!=typeof(s=t)&&"number"!=typeof s)throw new d("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new d("The key __proto__ is not allowed");o.key=t,o.type="map_value";continue e}if(o.map[o.key]=t,o.readCount++,o.readCount!==o.size){o.key=null,o.type=P;continue e}r.pop(),t=o.map}}return t}var s},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new d("Unrecognized array type byte: ".concat(T(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new d("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:P,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new d("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:C,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new d("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw V;var i,r=this.pos+t;return i=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,r,e):u(this.bytes,r,e),this.pos+=t+e,i},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&this.stack[this.stack.length-1].type===P},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new d("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw V;var n=this.pos+t,i=this.bytes.subarray(n,n+e);return this.pos+=t+e,i},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new d("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=w(this.view,this.pos);return this.pos+=8,e},e.prototype.readU64AsBigInt=function(){var e=this.view.getBigUint64(this.pos);return this.pos+=8,e},e.prototype.readI64AsBigInt=function(){var e=this.view.getBigInt64(this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}();var R=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},H=function(e){return this instanceof H?(this.v=e,this):new H(e)},G=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof H?Promise.resolve(n.value.v).then(c,u):h(o[0][2],n)}catch(e){h(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}};function $(e){return G(this,arguments,(function(){var t,n,i,r;return R(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,H(t.read())];case 3:return n=o.sent(),i=n.done,r=n.value,i?[4,H(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return function(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}(r),[4,H(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function K(e){return null!=e[Symbol.asyncIterator]?e:$(e)}var q=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},X=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};var Q=n(Object.freeze({__proto__:null,DataViewIndexOutOfBoundsError:z,DecodeError:d,Decoder:W,EXT_TIMESTAMP:-1,Encoder:I,ExtData:l,ExtensionCodec:A,decode:function(e,t){return new W(t).decode(e)},decodeArrayStream:function(e,t){var n=K(e);return new W(t).decodeArrayStream(n)},decodeAsync:function(e,t){return q(this,void 0,void 0,(function(){var n;return X(this,(function(i){return n=K(e),[2,new W(t).decodeAsync(n)]}))}))},decodeMulti:function(e,t){return new W(t).decodeMulti(e)},decodeMultiStream:function(e,t){var n=K(e);return new W(t).decodeStream(n)},decodeStream:undefined,decodeTimestampExtension:x,decodeTimestampToTimeSpec:U,encode:function(e,t){return new I(t).encodeSharedRef(e)},encodeDateToTimeSpec:m,encodeTimeSpecToTimestamp:b,encodeTimestampExtension:S})),J={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isDirectoryMetadata=e.isDirectory=void 0;e.isDirectory=e=>!!e&&!(e instanceof ArrayBuffer||"length"in e&&"number"==typeof e.length)&&"object"==typeof e&&!Array.isArray(e);e.isDirectoryMetadata=t=>(0,e.isDirectory)(t)&&(0,e.isDirectory)(t.files)}(J);var Y="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Z(){throw new Error("setTimeout has not been defined")}function ee(){throw new Error("clearTimeout has not been defined")}var te=Z,ne=ee;function ie(e){if(te===setTimeout)return setTimeout(e,0);if((te===Z||!te)&&setTimeout)return te=setTimeout,setTimeout(e,0);try{return te(e,0)}catch(t){try{return te.call(null,e,0)}catch(t){return te.call(this,e,0)}}}"function"==typeof Y.setTimeout&&(te=setTimeout),"function"==typeof Y.clearTimeout&&(ne=clearTimeout);var re,oe=[],se=!1,ae=-1;function ce(){se&&re&&(se=!1,re.length?oe=re.concat(oe):ae=-1,oe.length&&ue())}function ue(){if(!se){var e=ie(ce);se=!0;for(var t=oe.length;t;){for(re=oe,oe=[];++ae<t;)re&&re[ae].run();ae=-1,t=oe.length}re=null,se=!1,function(e){if(ne===clearTimeout)return clearTimeout(e);if((ne===ee||!ne)&&clearTimeout)return ne=clearTimeout,clearTimeout(e);try{return ne(e)}catch(t){try{return ne.call(null,e)}catch(t){return ne.call(this,e)}}}(e)}}function he(e,t){this.fun=e,this.array=t}he.prototype.run=function(){this.fun.apply(null,this.array)};function le(){}var fe=le,de=le,pe=le,ye=le,we=le,ge=le,ve=le;var be=Y.performance||{},me=be.now||be.mozNow||be.msNow||be.oNow||be.webkitNow||function(){return(new Date).getTime()};var Se=new Date;var Ue={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];oe.push(new he(e,t)),1!==oe.length||se||ie(ue)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:fe,addListener:de,once:pe,off:ye,removeListener:we,removeAllListeners:ge,emit:ve,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*me.call(be),n=Math.floor(t),i=Math.floor(t%1*1e9);return e&&(n-=e[0],(i-=e[1])<0&&(n--,i+=1e9)),[n,i]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Se)/1e3}};function xe(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Be(e,t){for(var n,i="",r=0,o=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(o===a-1||1===s);else if(o!==a-1&&2===s){if(i.length<2||2!==r||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",r=0):r=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),o=a,s=0;continue}}else if(2===i.length||1===i.length){i="",r=0,o=a,s=0;continue}t&&(i.length>0?i+="/..":i="..",r=2)}else i.length>0?i+="/"+e.slice(o+1,a):i=e.slice(o+1,a),r=a-o-1;o=a,s=0}else 46===n&&-1!==s?++s:s=-1}return i}var Ae={resolve:function(){for(var e,t="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var r;i>=0?r=arguments[i]:(void 0===e&&(e=Ue.cwd()),r=e),xe(r),0!==r.length&&(t=r+"/"+t,n=47===r.charCodeAt(0))}return t=Be(t,!n),n?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(xe(e),0===e.length)return".";var t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=Be(e,!t)).length||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return xe(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];xe(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":Ae.normalize(e)},relative:function(e,t){if(xe(e),xe(t),e===t)return"";if((e=Ae.resolve(e))===(t=Ae.resolve(t)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var i=e.length,r=i-n,o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var s=t.length-o,a=r<s?r:s,c=-1,u=0;u<=a;++u){if(u===a){if(s>a){if(47===t.charCodeAt(o+u))return t.slice(o+u+1);if(0===u)return t.slice(o+u)}else r>a&&(47===e.charCodeAt(n+u)?c=u:0===u&&(c=0));break}var h=e.charCodeAt(n+u);if(h!==t.charCodeAt(o+u))break;47===h&&(c=u)}var l="";for(u=n+c+1;u<=i;++u)u!==i&&47!==e.charCodeAt(u)||(0===l.length?l+="..":l+="/..");return l.length>0?l+t.slice(o+c):(o+=c,47===t.charCodeAt(o)&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(xe(e),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,i=-1,r=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!r){i=o;break}}else r=!1;return-1===i?n?"/":".":n&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');xe(e);var n,i=0,r=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){var c=e.charCodeAt(n);if(47===c){if(!o){i=n+1;break}}else-1===a&&(o=!1,a=n+1),s>=0&&(c===t.charCodeAt(s)?-1==--s&&(r=n):(s=-1,r=a))}return i===r?r=a:-1===r&&(r=e.length),e.slice(i,r)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!o){i=n+1;break}}else-1===r&&(o=!1,r=n+1);return-1===r?"":e.slice(i,r)},extname:function(e){xe(e);for(var t=-1,n=0,i=-1,r=!0,o=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(47!==a)-1===i&&(r=!1,i=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!r){n=s+1;break}}return-1===t||-1===i||0===o||1===o&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+e+i:i}("/",e)},parse:function(e){xe(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,i=e.charCodeAt(0),r=47===i;r?(t.root="/",n=1):n=0;for(var o=-1,s=0,a=-1,c=!0,u=e.length-1,h=0;u>=n;--u)if(47!==(i=e.charCodeAt(u)))-1===a&&(c=!1,a=u+1),46===i?-1===o?o=u:1!==h&&(h=1):-1!==o&&(h=-1);else if(!c){s=u+1;break}return-1===o||-1===a||0===h||1===h&&o===a-1&&o===s+1?-1!==a&&(t.base=t.name=0===s&&r?e.slice(1,a):e.slice(s,a)):(0===s&&r?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(s,o),t.base=e.slice(s,a)),t.ext=e.slice(o,a)),s>0?t.dir=e.slice(0,s-1):r&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Ae.posix=Ae;var Ee=Ae,Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),function(e){var n=t&&t.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=t&&t.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)},r=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.extractAll=e.getHeader=e.extractFile=e.readArchiveHeaderSync=void 0;const o=Q,s=J,a=r(Ee);i(Ie,e);const c=new o.Decoder,u=({basePath:e,metadata:t,filesOffset:n})=>Object.entries(t.files).flatMap((([i,r])=>(0,s.isDirectoryMetadata)(r)?u({basePath:a.default.join(e,i),metadata:r,filesOffset:n}):{path:a.default.join(e,i),offset:Number(t.files[i][0]),size:t.files[i][1],fileOffset:n+8+Number(t.files[i][0])})),h=({basePath:e,metadata:t,filesOffset:n})=>(0,s.isDirectoryMetadata)(t)?Object.fromEntries(Object.entries(t.files).map((([t,i])=>[t,h({basePath:a.default.join(e,t),metadata:i,filesOffset:n})]))):{path:e,offset:Number(t[0]),size:Number(t[1]),fileOffset:n+8+t[0]},l=({flat:e,header:t,filesOffset:n})=>e?u({metadata:t,basePath:"/",filesOffset:n}):h({metadata:t,basePath:"/",filesOffset:n}),f=(e,t)=>{if("string"!=typeof t)return;if(!(t=t.replace(/^\//,"")))return e;const n=a.default.basename(t),i=((e,t)=>{let n=e;const i=t.split(a.default.sep);for(const e of i)"."!==e&&(n=n.files[e]);return n})(e,a.default.dirname(t));return null===i.files&&(i.files={}),null===i.files[n]&&(i.files[n]=[0,0]),i.files[n]};e.readArchiveHeaderSync=e=>{const t=new DataView(e).getUint32(4,!0),n=new DataView(e.slice(8,16)).getInt32(4,!0);return{header:c.decode(e.slice(16,16+n)),headerSize:t}};const d=e=>e instanceof ArrayBuffer?Promise.resolve(e):new Blob([e]).arrayBuffer();e.extractFile=async(e,t)=>{const n=await d(e),i=new DataView(n).getUint32(4,!0),r=new DataView(n).getUint32(12,!0),o=n.slice(16,r+16),s=c.decode(o),[a,u]=f(s,t);return n.slice(i+Number(a)+8,i+Number(a)+u+8)};const p=(e,t,n,i)=>new Blob(n).arrayBuffer().then((n=>{const r=c.decode(new Uint8Array(n,16,e));return{headerSize:e,filesOffset:t,header:l({flat:i,header:r,filesOffset:t})}}));e.getHeader=async(e,t)=>{const n=new Response(e).body.getReader(),i=async(e=0,r,o,s=[])=>{var a,c;if(r&&e>=r)return await n.cancel(),p(r,o,s,null!==(a=null==t?void 0:t.flat)&&void 0!==a&&a);const{value:u,done:h}=await n.read();return h?p(r,o,s,null!==(c=null==t?void 0:t.flat)&&void 0!==c&&c):i(e+u.byteLength,e+u.byteLength>=16?null!=r?r:new DataView(u.buffer,8,16).getInt32(4,!0):void 0,e+u.byteLength>=16?null!=r?r:new DataView(u.buffer).getUint32(4,!0):void 0,[...s,u])};return i()};e.extractAll=async(t,n)=>{const i=await d(t),{header:r}=await(0,e.getHeader)(i,{flat:null==n?void 0:n.flat});if(null==n?void 0:n.flat)return Object.fromEntries(await Promise.all(r.map((({path:e})=>e)).map((async t=>[t,await(0,e.extractFile)(i,t)]))));const o=async t=>Object.fromEntries(await Promise.all(Object.entries(t).map((async([t,n])=>[t,"object"==typeof n?await o(n):await(0,e.extractFile)(i,n)]))));return o(r)}}(i);const Te="Checking for updates...",ke="Downloading update package...",_e="Installing update package...";class Me{constructor(e,t,n){this._FS=e,this._IDBFS=t,this._callback=n,this.exists=e=>this._FS.analyzePath(e).exists,this.join=(e,t)=>`${e}/${t}`,this.serverVersion="",this.version="",this.check=async()=>{this._callback({status:Te,progress:0,step:0});const e=this.exists("/content/version.txt")?this._FS.readFile("/content/version.txt",{encoding:"utf8"}):"0";console.log(`Content version: ${e}`);const t=await(await fetch("version.txt")).text();return console.log(`Server version: ${t}`),this._callback({status:Te,progress:100,step:0}),this.version=e,this.serverVersion=t,{version:e,serverVersion:t}},this.install=async()=>{this._callback({status:ke,progress:0,step:1});let e=new XMLHttpRequest;e.open("GET","Content.asar",!0),e.responseType="arraybuffer",e.onprogress=e=>{e.lengthComputable&&this._callback({status:ke,progress:e.loaded/e.total,step:1})};const t=await new Promise(((t,n)=>{e.onload=()=>t(e.response),e.send()}));this._callback({status:_e,progress:0,step:2});const n=await i.extractAll(t,{flat:!0}),r=Object.keys(n).length;let o=0;for(const[e,t]of Object.entries(n)){if(!e)continue;const n=e.toLowerCase().split("/"),i=n[n.length-1],s=n.slice(0,n.length-1).join("/");if(s){const e=s.split("/").filter((e=>""!==e));let t="";for(const n of e)t=t+"/"+n,this.exists(t)||this._FS.mkdir(t)}if(i){const e=this.join(s,i);this.exists(e)&&this._FS.unlink(e),this._FS.writeFile(e,new Uint8Array(t)),this._callback({status:_e,progress:o/r,step:2})}o%15==0&&await new Promise(((e,t)=>{setTimeout((()=>e()),0)})),o++}this._FS.writeFile("/content/version.txt",this.serverVersion),await new Promise(((e,t)=>{this._FS.syncfs(!1,(()=>e()))}))}}}class Le{static beginShowMessageBox(e,t,n,i,r,o,s){const a={callback:s},c=document.createElement("dialog");c.className="message-dialog",c.innerHTML=`\n            <div class="message-dialog-content-root">\n                <div class="message-dialog-content-container">\n                    <h1 class="message-dialog-title">${t}</h1>\n                    <p class="message-dialog-content">${n}</p>\n                    <div class="message-dialog-button-container">\n                        ${i.map(((e,t)=>`<button id="button-${t}" ${t===r?'autofocus class="message-dialog-button primary"':'class="message-dialog-button"'}>${e}</button>`)).join("")}\n                    </div>\n                </div>\n            </div>\n        `;const u=e=>{void 0===e?a.callback(-1):a.callback(e);c.querySelector(".message-dialog-content-root").addEventListener("animationend",(()=>{c.remove()})),c.classList.add("closing")};i.forEach(((e,t)=>{c.querySelector(`#button-${t}`).addEventListener("click",(()=>{u(t)}))})),c.addEventListener("close",(()=>{u()})),c.addEventListener("cancel",(()=>{u()})),document.body.appendChild(c),c.showModal()}}const De=0,Oe=1;const Ce=document.querySelector("#uno-body"),Pe=document.querySelector("#progress"),je=document.querySelector("#status"),Fe=document.querySelector("#canvas"),ze=document.querySelector("#tap-to-play"),Ve=()=>{const e=window.innerWidth,t=window.innerHeight,n=Math.min(e/800,t/480);Fe.style.width=800*n+"px",Fe.style.height=480*n+"px",Fe.style.marginTop=(t-480*n)/2+"px"};window.onresize=Ve,window.addEventListener("appinstalled",(()=>{var e;"umami"in window&&(null===(e=window.umami)||void 0===e||e.track("App installed"))}));const{setModuleImports:Ne,getAssemblyExports:We,getConfig:Re}=await e.withDiagnosticTracing(!1).withApplicationArgumentsFromQuery().create(),He=e.instance.Module.FS,Ge=e.instance.Module.IDBFS,$e=await(Ke=He,qe=Ge,Xe=e=>{je.textContent=e.status,Pe.value=e.progress/3+e.step/3},new Promise(((e,t)=>{Ke.mkdir("/content"),Ke.mount(qe,{},"/content"),Ke.syncfs(!0,(()=>{e(new Me(Ke,qe,Xe))}))})));var Ke,qe,Xe;const{version:Qe,serverVersion:Je}=await $e.check();Qe!=Je&&await $e.install();const Ye=await We("Sonic4Episode1.Wasm.dll"),Ze=new class{constructor(e){this.audioBuffers={},this.volume=1,this.context=new AudioContext,this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.onEnded=this.onEnded.bind(this),this.isGarbage=""===document.createElement("audio").canPlayType("audio/ogg"),this.exports=e}setVolume(e){this.volume=e,this.gainNode.gain.value=e}getVolume(){return this.volume}play(e,t){this.getAudioBuffer(e).then((e=>{this.playQueue(e,t)}))}stop(){this.source&&(this.source.stop(),this.source=null)}preload(e){this.getAudioBuffer(e)}playQueue(e,t){this.source&&(this.source.removeEventListener("ended",this.onEnded),this.source.stop()),this.source=this.context.createBufferSource(),this.source.buffer=e,this.source.connect(this.gainNode),this.source.addEventListener("ended",this.onEnded),void 0!==t&&(console.log("Setting loop",t,e.duration),this.source.loopStart=t,this.source.loopEnd=e.duration,this.source.loop=!0),this.source.start(),this.setState(Oe)}getAudioBuffer(e){return e="."+e,this.isGarbage&&(e=e.substring(0,e.length-4)+".m4a"),window.fetch(e).then((e=>e.arrayBuffer())).then((e=>this.context.decodeAudioData(e))).then((t=>(this.audioBuffers[e]=t,t)))}onEnded(e){this.setState(De)}setState(e){this.exports.Microsoft.Xna.Framework.Media.WasmMediaPlayer.ChangeState(e)}}(Ye);Ne("main.js",{setMainLoop:t=>e.instance.Module.setMainLoop(t),MediaPlayer_GetVolume:Ze.getVolume.bind(Ze),MediaPlayer_SetVolume:Ze.setVolume.bind(Ze),MediaPlayer_Play:e=>Ze.play(e),MediaPlayer_PlayLooped:(e,t)=>Ze.play(e,t),MediaPlayer_LoadSong:e=>Ze.preload(e),MediaPlayer_Stop:Ze.stop.bind(Ze),XmlStorage_GetSaveFile:()=>localStorage.getItem("saveData"),XmlStorage_SetSaveFile:e=>localStorage.setItem("saveData",e),SaveState_GetSaveState:()=>localStorage.getItem("saveState"),SaveState_SetSaveState:e=>localStorage.setItem("saveState",e),SaveState_HasSaveState:()=>null!=localStorage.getItem("saveState"),SaveState_DeleteSaveState:()=>localStorage.removeItem("saveState"),Guide_BeginShowMessageBox:Le.beginShowMessageBox.bind(Le),WebBrowserTask_Open:e=>window.open(e,"_blank")}),e.instance.Module.canvas=Fe,Ce.style.display="none",ze.style.display="none",Ve(),Fe.focus(),await e.run();